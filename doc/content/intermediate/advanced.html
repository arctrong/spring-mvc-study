<!DOCTYPE html>
<html>
<head><title>Spring MVC advanced</title>
<meta charset="utf-8">
<link rel="shortcut icon" type="image/png" href="../../favicon.png"/>
<link rel="stylesheet" type="text/css" href="../../layout/styles.css"/>
<link rel="stylesheet" type="text/css" href="../../layout/layout.css"/>
<link rel="stylesheet" type="text/css" href="../../theme.css"/>

<style>
.headerNavArrows {position: relative; top: 3px;}
</style>
</head>
<body>

<div class="header"><b><span style="color:greenyellow;margin-right:7px;">Spring Web</span></b><a 
class="header_item" href="../../../readme.html">About</a><a 
class="header_item" href="../index_page.html">Index</a>

<a href="../../../doc_src/content/intermediate/advanced.txt " class="header_item_source" title="Source text">&lt;/&gt;</a>


<a href="formatters.html" title="Previous: Spring MVC Formatter"><img class="headerNavArrows" src="../../layout/pict/previous_page_h18px.png"/></a>


<img class="headerNavArrows" src="../../layout/pict/next_page_h18px_inactive.png"/>

<span class="headerTitle">Spring MVC advanced</span>

</div>

<div class="sidebar">
    <table class="sidebarAligner">
        <tr><td valign="top">
            <div class="sidebar_item"><a href="../../../readme.html">About the course</a></div>
<div class="sidebar_item"><a href="../references.html">References</a></div>
<div class="sidebar_item"><a href="../common_notes.html">Common notes</a></div>
            <h3>Beginner</h3>
            <div class="sidebar_item"><a href="../beginner/about_part_1.html">About this part</a></div>
<div class="sidebar_item"><a href="../beginner/server_setup.html">Server setup</a></div>
<div class="sidebar_item"><a href="../beginner/front_controller.html">Front controller</a></div>
<div class="sidebar_item"><a href="../beginner/spring_web_app_setup.html">Spring web application setup</a></div>
<div class="sidebar_item"><a href="../beginner/web_application_context.html">Web application context</a></div>
<div class="sidebar_item"><a href="../beginner/view_resolver.html">View resolver</a></div>
<div class="sidebar_item"><a href="../beginner/model.html">Model</a></div>
            <h3>Intermediate</h3>
            <div class="sidebar_item"><a href="about_part_2.html">About this part</a></div>
<div class="sidebar_item"><a href="get_rid_of_web_xml.html">Get rid of XML configuration</a></div>
<div class="sidebar_item"><a href="data_binding.html">Data binding</a></div>
<div class="sidebar_item"><a href="registration_form.html">Registration form</a></div>
<div class="sidebar_item"><a href="form_validation.html">Form validation</a></div>
<div class="sidebar_item"><a href="formatters.html">Spring MVC Formatter</a></div>
<div class="sidebar_item selected"><a href="advanced.html">Spring MVC advanced</a></div>
            <h3>Useful links</h3>
            <div class="sidebar_item"><a href="https://spring.io/">Spring site</a></div>
        </td></tr>
        <tr><td class="bottom" valign="bottom">
            Generated by md2html_py 1.0.2
            <br />2023-03-29 00:16:37
        </td></tr>
    </table>
</div>

<p style="font-size:44px;font-weight:bold;margin:0 0 30px 0;">Spring MVC advanced</p>

<div class="toc">
<ul>
<li><a href="#preliminary-note">Preliminary note</a></li>
<li><a href="#initbinder-introduction">InitBinder introduction</a></li>
<li><a href="#property-editor">Property editor</a></li>
<li><a href="#built-in-property-editors">Built-in property editors</a></li>
<li><a href="#writing-a-custom-property-editor">Writing a custom property editor</a></li>
<li><a href="#converter-interface">Converter interface</a></li>
</ul>
</div>
<hr />
<p>Mar 28, 2023</p>
<h1 id="preliminary-note">Preliminary note</h1>
<p>The <em>property editors</em> described in this section have the same functions as the <em>formatters</em> 
described <a href="formatters.html">here</a>. </p>
<p>Another alternative is the <code>Converter</code> interface described 
<a href="advanced.html#converter_interface">here</a>.</p>
<hr />
<p><a name="index_entry_index_1"></a></p>
<h1 id="initbinder-introduction">InitBinder introduction</h1>
<p>[<a href="../references.html#ref_2_11">2.11</a>, <a href="https://youtu.be/ms4ywje7EYI?t=330">5:30</a>]</p>
<p>In the <a href="../../../projects/web-app-spring-adv2/src/main/java/springmvcstudy2/controllers/RegistrationController.java"><code>RegistrationController</code></a>
class add the following method:</p>
<pre class="highlight"><code class="language-code">    .  .  .
    @InitBinder
    public void initBinder(WebDataBinder dataBinder) {
        System.out.println("inside @InitBinder method");
        dataBinder.setDisallowedFields("name");
    }
    .  .  .</code></pre>
<p>The annotation we use is <code>@org.springframework.web.bind.annotation.InitBinder</code>. </p>
<p>This method will be called each time any request handler method of this controller is called.
In this example it removes the field named <code>name</code> from the data model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Actually this field is sent in the URL
<code>http://localhost:8080/web-app-spring-adv2/ui/registration-success?name=aaaaa&amp;userName=bbbbb&amp;...</code>,
it's just not shown on the page.</p>
</div>
<blockquote>
<p>Git commit: <code>79b9c52328730769fd4f43190a81e98357105220</code> property editor basics</p>
</blockquote>
<hr />
<p><a name="index_entry_index_2"></a></p>
<h1 id="property-editor">Property editor</h1>
<p>[<a href="../references.html#ref_2_11">2.11</a>, <a href="https://youtu.be/ms4ywje7EYI?t=1911">31:51</a>]</p>
<p>In the <a href="../../../projects/web-app-spring-adv2/src/main/java/springmvcstudy2/controllers/RegistrationController.java"><code>RegistrationController</code></a>
class <code>@InitBinder</code> annotated method register a <code>StringTrimmerEditor</code>:</p>
<pre class="highlight"><code class="language-code">    .  .  .
    @InitBinder
    public void initBinder(WebDataBinder dataBinder) {
        System.out.println("inside @InitBinder method");
        StringTrimmerEditor trimmerEditor = new StringTrimmerEditor(true);
        dataBinder.registerCustomEditor(String.class, "name", trimmerEditor);
    }
    .  .  .</code></pre>
<p>Then the value of the <code>name</code> field will be trimmed. This is a simple example demonstrating the 
property editor concept.</p>
<p>If a text is entered into a text field that represent, for example, an integer model field, the 
property editing concept works for transformation. There's a default data binder that was
implicitly used in our previous examples. But just the simplest automatic data binding is 
activated by default. For more complex cases we need to write our custom data binders.</p>
<p>The <code>WebDataBinder</code> object allow us registering:</p>
<ul>
<li>custom editors;</li>
<li>validators;</li>
<li>"required" properties;</li>
<li>allowed/disallowed properties.</li>
</ul>
<hr />
<h1 id="built-in-property-editors">Built-in property editors</h1>
<p>[<a href="../references.html#ref_2_11">2.11</a>, <a href="https://youtu.be/ms4ywje7EYI?t=2615">43:35</a>]</p>
<p>For the Built-in property editors list see [<a href="../references.html#ref_15">15</a>, 
<a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/core.html#beans-beans-conversion">3.3.2. Built-in <code>PropertyEditor</code> Implementations</a>].</p>
<p>Some demonstration is done in the video about the property editor usage that are too long and
not so much important for the goals of this course.</p>
<hr />
<h1 id="writing-a-custom-property-editor">Writing a custom property editor</h1>
<p>[<a href="../references.html#ref_2_11">2.11</a>, <a href="https://youtu.be/ms4ywje7EYI?t=4278">1:11:18</a>]</p>
<p>We are going to convert the "Name" field to upper case. It's pretty simple. First create a new 
property editor <a href="../../../projects/web-app-spring-adv2/src/main/java/springmvcstudy2/propertyeditor/NamePropertyEditor.java"><code>NamePropertyEditor</code></a>:</p>
<p><a name="index_entry_index_3"></a>
<pre class="highlight"><code class="language-code">public class NamePropertyEditor extends PropertyEditorSupport {

    @Override
    public void setAsText(String text) throws IllegalArgumentException {
        setValue(text.toUpperCase());
    }
}</code></pre></p>
<p>The <code>setValue()</code> method comes from the <code>java.beans.PropertyEditorSupport</code> base class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>PropertyEditorSupport</code> class has the method <code>getAsText()</code> that id analogous to the 
method <code>print()</code> of the <code>Formatter</code> interface (see 
<a href="formatters.html#using_print_mathod">here</a>).</p>
</div>
<p>Then we just add the newly created property editor to the <a href="../../../projects/web-app-spring-adv2/src/main/java/springmvcstudy2/controllers/RegistrationController.java"><code>RegistrationController</code></a>
class:</p>
<pre class="highlight"><code class="language-code">    .  .  .
    @InitBinder
    public void initBinder(WebDataBinder dataBinder) {
        System.out.println("inside @InitBinder method");
        StringTrimmerEditor trimmerEditor = new StringTrimmerEditor(true);
        dataBinder.registerCustomEditor(String.class, "name", trimmerEditor);
        dataBinder.registerCustomEditor(String.class, "name", new NamePropertyEditor());
    }
    .  .  .</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Looks like the previous <code>StringTrimmerEditor</code> property editor stops working after registering
a new property editor.</p>
</div>
<blockquote>
<p>Git commit: <code>8e545bf252eed82ecc3cb873937c975470860df2</code> custom property editor implemented</p>
</blockquote>
<hr />
<p><a name="index_entry_index_4"></a><a name="converter_interface"></a></p>
<h1 id="converter-interface"><code>Converter</code> interface</h1>
<p>[<a href="../references.html#ref_2_11">2.11</a>, <a href="https://youtu.be/ms4ywje7EYI?t=6769">1:52:49</a>]</p>
<p>There's yet another mechanism for converting &mdash; the parameterized
<code>org.springframework.core.convert.converter.Converter</code> interface that has the <code>convert()</code> method
that concrete converters must override and where actual conversion is performed.
The converters must be added in the configuration class like <a href="../../../projects/web-app-spring-adv2/src/main/java/springmvcstudy2/config/MyApplicationConfig.java"><code>MyApplicationConfig</code></a>
in the <code>addFormatters()</code> method using the <code>FormatterRegistry#addConverter</code> method.</p>
<p>The <code>Converter</code> interface has only a one-way conversion method. For the reverse conversion another 
converter must be created.</p>
<p>&nbsp;</p>
<hr />

<p style="margin-top:0px;margin-bottom:0px;text-align:right;"><a href="formatters.html" 
title="Previous: Spring MVC Formatter"><img src="../../layout/pict/previous_page.png"/></a>


<img src="../../layout/pict/next_page_inactive.png"/></p>

<div style="height: 1000px;"><p>&nbsp;</p></div>

</body>
</html>

<!DOCTYPE html>
<html>
<head><title>Send email</title>
<meta charset="utf-8">
<link rel="shortcut icon" type="image/png" href="../../favicon.png"/>
<link rel="stylesheet" type="text/css" href="../../layout/styles.css"/>
<link rel="stylesheet" type="text/css" href="../../layout/layout.css"/>
<link rel="stylesheet" type="text/css" href="../../theme.css"/>

<style>
.headerNavArrows {position: relative; top: 3px;}
</style>
</head>
<body>

<div class="header"><b><span style="color:greenyellow;margin-right:7px;">Spring Web</span></b><a 
class="header_item" href="../../../readme.html">About</a><a 
class="header_item" href="../index_page.html">Index</a>

<a href="../../../doc_src/content/intermediate/send_email.txt " class="header_item_source" title="Source text">&lt;/&gt;</a>


<a href="formatters.html" title="Previous: Spring MVC Formatter"><img class="headerNavArrows" src="../../layout/pict/previous_page_h18px.png"/></a>

<a href="sessions_and_cookies.html" title="Next: Sessions and cookies"><img class="headerNavArrows" src="../../layout/pict/next_page_h18px.png"/></a>


<span class="headerTitle">Send email</span>

</div>

<div class="sidebar">
    <table class="sidebarAligner">
        <tr><td valign="top">
            <div class="sidebar_item"><a href="../../../readme.html">About the course</a></div>
<div class="sidebar_item"><a href="../references.html">References</a></div>
<div class="sidebar_item"><a href="../common_notes.html">Common notes</a></div>
            <h3>Beginner</h3>
            <div class="sidebar_item"><a href="../beginner/about_part_1.html">About this part</a></div>
<div class="sidebar_item"><a href="../beginner/server_setup.html">Server setup</a></div>
<div class="sidebar_item"><a href="../beginner/front_controller.html">Front controller</a></div>
<div class="sidebar_item"><a href="../beginner/spring_web_app_setup.html">Spring web application setup</a></div>
<div class="sidebar_item"><a href="../beginner/web_application_context.html">Web application context</a></div>
<div class="sidebar_item"><a href="../beginner/view_resolver.html">View resolver</a></div>
<div class="sidebar_item"><a href="../beginner/model.html">Model</a></div>
            <h3>Intermediate</h3>
            <div class="sidebar_item"><a href="about_part_2.html">About this part</a></div>
<div class="sidebar_item"><a href="get_rid_of_web_xml.html">Get rid of XML configuration</a></div>
<div class="sidebar_item"><a href="data_binding.html">Data binding</a></div>
<div class="sidebar_item"><a href="registration_form.html">Registration form</a></div>
<div class="sidebar_item"><a href="form_validation.html">Form validation</a></div>
<div class="sidebar_item"><a href="formatters.html">Spring MVC Formatter</a></div>
<div class="sidebar_item selected"><a href="send_email.html">Send email</a></div>
<div class="sidebar_item"><a href="sessions_and_cookies.html">Sessions and cookies</a></div>
        </td></tr>
        <tr><td class="bottom" valign="bottom">
            Generated by <a href="https://github.com/arctrong/md2html">md2html_py</a> 1.0.2
            <br />2023-03-30
        </td></tr>
    </table>
</div>

<p style="font-size:44px;font-weight:bold;margin:0 0 30px 0;">Send email</p>

<div class="toc">
<ul>
<li><a href="#project-arrangements">Project arrangements</a></li>
<li><a href="#creating-the-forms">Creating the forms</a></li>
<li><a href="#using-path-variables">Using path variables</a><ul>
<li><a href="#using-a-map">Using a Map</a></li>
</ul>
</li>
<li><a href="#why-not-to-send-data-in-the-url">Why not to send data in the URL?</a></li>
</ul>
</div>
<hr />
<p>Mar 29, 2023</p>
<h1 id="project-arrangements">Project arrangements</h1>
<p>Maven project <code>web-app-spring-adv2</code> was copied to <code>web-app-spring-adv3</code> to leave the previous
changes untouched.</p>
<hr />
<h1 id="creating-the-forms">Creating the forms</h1>
<p>[<a href="../references.html#ref_2_12">2.12</a>, <a href="https://youtu.be/xhKP9o9I85g?t=476">7:56</a>]</p>
<p>On the existing view <a href="../../../projects/web-app-spring-adv2/src/main/webapp/view/result-page-spring.jsp"><code>result-page-spring.jsp</code></a>
adding a link for sending an email:</p>
<p><img alt="" src="../../pict/send_email_01.png" /></p>
<p><a name="index_entry_index_1"></a>
The <code>pageContext</code> is an implicit variable accessible in all JSP pages.</p>
<p>The URL is <a href="http://localhost:8080/web-app-spring-adv3/ui/validate-submit?name1=Bob&amp;name2=Claudia&amp;notARobot=true&amp;_notARobot=on">http://localhost:8080/web-app-spring-adv3/ui/validate-submit?...</a>.</p>
<p>The email inputting form <a href="../../../projects/web-app-spring-adv3/src/main/webapp/WEB-INF/view/send-email-page.jsp"><code>send-email-page.jsp</code></a>
is created:</p>
<p><img alt="" src="../../pict/send_email_02.png" /></p>
<p>The URL is <a href="http://localhost:8080/web-app-spring-adv3/ui/sendEmail">http://localhost:8080/web-app-spring-adv3/ui/sendEmail</a>.</p>
<p>The email sending successful page <a href="../../../projects/web-app-spring-adv3/src/main/webapp/WEB-INF/view/process-email-page.jsp"><code>process-email-page.jsp</code></a>
is created:</p>
<p><img alt="" src="../../pict/send_email_03.png" /></p>
<p>The URL is <a href="http://localhost:8080/web-app-spring-adv3/ui/process-email?userEmail=myemail%40domain.com">http://localhost:8080/web-app-spring-adv3/ui/process-email?userEmail=myemail%40domain.com</a>.</p>
<p>The controller is <a href="../../../projects/web-app-spring-adv3/src/main/java/springmvcstudy2/controllers/EmailController.java"><code>EmailController</code></a>.</p>
<p>the model DTO is <a href="../../../projects/web-app-spring-adv3/src/main/java/springmvcstudy2/model/SendEmailDto.java"><code>SendEmailDto</code></a>.</p>
<p>See the below commit for the implementation details.</p>
<blockquote>
<p>Git commit: <code>c23f1c1ba16e42cc1b8a702951b488830930c8ac</code> send email skeleton forms created</p>
</blockquote>
<p>See <a href="../beginner/server_setup.html#project_start_on_server">here</a> for information about the project start.</p>
<hr />
<p><a name="index_entry_index_2"></a></p>
<h1 id="using-path-variables">Using path variables</h1>
<p>[<a href="../references.html#ref_2_12">2.12</a>, <a href="https://youtu.be/xhKP9o9I85g?t=1595">26:35</a>]</p>
<p>Here we are going to send the user name parameter through URL path.</p>
<p>In the <a href="../../../projects/web-app-spring-adv2/src/main/webapp/view/result-page-spring.jsp"><code>result-page-spring.jsp</code></a>
view adding a variable path segment to the link URL:</p>
<pre class="highlight"><code class="language-xml">&lt;p&gt;&lt;a href="${pageContext.request.contextPath}/ui/sendEmail/${dto.name1}"
&gt;Send result to your email&lt;/a&gt;&lt;/p&gt;</code></pre>
<p>In the <a href="../../../projects/web-app-spring-adv3/src/main/java/springmvcstudy2/controllers/EmailController.java"><code>EmailController</code></a>
class do some modification to the corresponding controller method:</p>
<pre class="highlight"><code class="language-code">    @RequestMapping("/sendEmail/{userName}")
    public String sendEmail(@PathVariable String userName, Model model) {
        model.addAttribute("sendEmailDto", new SendEmailDto());
        model.addAttribute("userName", userName);
        return "send-email-page";
    }</code></pre>
<p>As we explicitly added a <code>Model</code> argument we now need to populate it completely.
Also the <code>@PathVariable</code> annotation may have a parameter specifying the path variable name
if it differs from the method parameter name.</p>
<p>After that is done, the URL will become like this:
<a href="http://localhost:8080/web-app-spring-adv3/ui/sendEmail/Bob">http://localhost:8080/web-app-spring-adv3/ui/sendEmail/Bob</a>.</p>
<p>In the <a href="../../../projects/web-app-spring-adv3/src/main/webapp/WEB-INF/view/send-email-page.jsp"><code>send-email-page.jsp</code></a>
using the new model attribute:</p>
<pre class="highlight"><code class="language-xml">.  .  .
&lt;h1&gt;Hi ${userName}!&lt;/h1&gt;
.  .  .</code></pre>
<blockquote>
<p>Git commit: <code>236fe6a16456e9d45e935d6849e5adb8bb1eb7e8</code> path variable used</p>
</blockquote>
<h2 id="using-a-map">Using a <code>Map</code></h2>
<p>[<a href="../references.html#ref_2_12">2.12</a>, <a href="https://youtu.be/xhKP9o9I85g?t=2857">47:37</a>]</p>
<p>The alternative path variable access method is using a <code>Map</code> (see the <a href="../../../projects/web-app-spring-adv3/src/main/java/springmvcstudy2/controllers/EmailController.java"><code>EmailController</code></a>
class):</p>
<pre class="highlight"><code class="language-code">    @RequestMapping("/sendEmail/{userName}")
    public String sendEmail(@PathVariable Map&lt;String, String&gt; pathVariables, Model model) {
        model.addAttribute("sendEmailDto", new SendEmailDto());
        model.addAttribute("userName", pathVariables.get("userName"));
        return "send-email-page";
    }</code></pre>
<blockquote>
<p>Git commit: <code>cb8843c8ea7c29ae9f62b19fa915e14a8d9c74e4</code> path variable used with a Map</p>
</blockquote>
<hr />
<h1 id="why-not-to-send-data-in-the-url">Why not to send data in the URL?</h1>
<p>[<a href="../references.html#ref_2_12">2.12</a>, <a href="https://youtu.be/xhKP9o9I85g?t=3047">50:47</a>]</p>
<p>There are some problems with sending data through the URL:</p>
<ul>
<li>The data must be sent throughout all the pages that need this data.</li>
<li>If the link is bookmarked of sent to the other user it will contain irrelevant data.</li>
</ul>
<p>The solution will be discussed in the upcoming sections.</p>
<p>&nbsp;</p>
<hr />

<p style="margin-top:0px;margin-bottom:0px;text-align:right;"><a href="formatters.html" 
title="Previous: Spring MVC Formatter"><img src="../../layout/pict/previous_page.png"/></a>

<a href="sessions_and_cookies.html" title="Next: Sessions and cookies"><img 
src="../../layout/pict/next_page.png"/></a>
</p>

<div style="height: 1000px;"><p>&nbsp;</p></div>

</body>
</html>
